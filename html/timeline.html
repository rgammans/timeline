<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title> Example Timeline</title>
    <!-- CSS -->
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.7.0/vis.min.css">
      <link rel="stylesheet" type="text/css" href="../css/ui/jquery-ui.min.css" />   
      <link rel="stylesheet" type="text/css" href="../css/ui/datepicker.css" />   
       <!-- JS  from CDNs-->
      <script type='text/javascript' src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.7.0/vis.js"></script>
      <script type='text/javascript' src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>

    <!-- Our JS from bowe -->
      <script type='text/javascript' src="../lib/jquery.js"></script>
      <script type='text/javascript' src="../lib/jquery-ui.min.js"></script>
      <script type='text/javascript' src="../lib/ui/datepicker.js"></script>
    <!-- Our JS (+ Pollyfills )-->
      <script type='text/javascript' src="../lib/rel_moment.js"></script>
      <script type='text/javascript' src="../lib/app.js"></script>
      <script type='text/javascript' src="../lib/simpleFile.js"></script>
      <script type='text/javascript' src="../lib/browser-polyfill.js"></script>
  <style type='text/css'>
  </style>
</head>
<body>
<a href="https://github.com/rgammans/timeline"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
<P>
<h2>Example Timeline</h2>
<P>
    <span id="warn">Please note you will need internet access for this to work. Either you don't have it or an error occured</span>
   <p>

    <div id="vis"></div>

    <div id="edit-form">
        <form>
        <div class="absolute_form">
            <div class="inner-wrapper">
                <input class="input idfield" name="id" type="hidden">
                <input class="input textfield" name="label" type="text">
                <input class="input startfield" name="start" type="text">
                <input class="input startfield_alt" name="start_alt" type="hidden">
                <input class="input endfield" name="end" type="text">
                <input class="input endfield_alt" name="end_alt" type="hidden">
                <button onclick="app.update_entry()" type="button">Update</button>
            </div>
        </div>
    </div>

    <div class="save_load_panel">
    <button onclick="download(app.serialize(),'timeline.jsn','text/json')" type="button">Save Data</button>
    <br>
    <div id="filebox" ></div>
    </div>
</body>
<script>

/** Helper function from http://stackoverflow.com/questions/13405129 */
function download(text, name, type) {
    var a = document.createElement("a");
    var file = new Blob([text], {type: type});
    a.href = URL.createObjectURL(file);
    a.download = name;
    a.click();
}
var x;
$(function() {
    document.x= new SimpleFileReader($('#filebox'),'fileload',{
        display_content:true,
        onload: function(data) { app.unserialize(data); }
    });

    //** Define View handlers **/
    $('.absolute_form .startfield').datepicker( {
        altFormat:"yy-mm-dd",
        dateFormat:"dd/mm/yy",
        altField:$('.absolute_form .startfield_alt')
    });
    $('.absolute_form .endfield').datepicker( {
        altFormat:"yy-mm-dd",
        dateFormat:"dd/mm/yy",
        altField:$('.absolute_form .endfield_alt')
    });

    function _update_datepicker(picker, newd) {
        picker.datepicker('setDate',newd);
    }

    form_methods = {
        set_startDate : function (d) {
            _update_datepicker($('.absolute_form .startfield'),d);
        },
        set_endDate : function (d) {
            _update_datepicker($('.absolute_form .endfield'),d);
        },
        set_text : function (d) {
            $('.absolute_form .textfield').prop('value',d);
        },
        set_id : function (d) {
            $('.absolute_form .idfield').prop('value',d);
        },
        get_startDate : function (d) {
            return $('.absolute_form .startfield_alt').prop('value');
        },
        get_endDate : function (d) {
            return $('.absolute_form .endfield_alt').prop('value');
        },
        get_text : function (d) {
            return $('.absolute_form .textfield').prop('value');
        },
        get_id : function (d) {
            return $('.absolute_form .idfield').prop('value');
        },
        disable_text : function (d) {
            $('.absolute_form .textfield').prop('diabled',d);
        },
        disable_id : function (d) {
            $('.absolute_form .idfield').prop('disabled',d);
        },
        disable_startDate : function (d) {
            $('.absolute_form .startfield').prop('disabled',d);
        },
        disable_endDate : function (d) {
            return $('.absolute_form .endfield').prop('disabled',d);
        },


    }

});
</script>
<script type='text/javascript'>
$(function(){
    /**
    *  Initialise the dataset and launch the main app controller 
    */
    var container = document.getElementById('vis');
     app = new TimelineRelations();

//*************************************************************************************************************************
// Make your edits here between these two rows of stars

game_start =            app.create_event("Game Start",                          moment("2015-12-21"));
s_happen =              app.create_event("Something Happend",                   new MemoryMoment(game_start).subtract(2,'months'));
                        app.create_event("Guy Fawkes",                          moment("2015-11-05"));
other =                 app.create_event("Another thing happens",               s_happen.add(1,'day')); 
today              =    app.create_event("England declares WAR!",               moment());

//****************************************************************************************************************************

    app.run(container,form_methods);
    document.getElementById('warn').style.display = "none";
});
</script>


</html>

